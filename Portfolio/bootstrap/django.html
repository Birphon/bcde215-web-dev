<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home</title>

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/styles.css">
</head>

<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="index.html">Home</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="ec2_linux_setup.html">AWS Setup</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="web_server_install.html">Website Server Install</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="website_setup_instruction.html">Website Setup</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="backup_instructions.html">Backup Setup</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="tips.html">Tips</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="django.html">Django Setup</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container mt-4">
        <div class="row">
            <div class="col-lg-8 offset-lg-2">
                <!-- Section: Introduction -->
                <section>
                    <h1 class="text-center">Welcome to a Django Setup Tutorial</h1>
                    <br>
                    <p>This will run you through the basics to get a Django Website up and running. Everything in
                        <b>Square Brackets []</b> needs to be changed
                    </p>
                    <p>As mentioned on the Home Page - Errors can and will happen even if you follow this to a T</p>
                </section>

                <section>
                    <h2> Certbotting </h2>
                    <p> I like to run through the Certbot process first just so no issues happen here: </p>
                    <p>
                        <pem>
                            <code>
                                sudo cp /etc/apache2/sites-available/000-default.conf /etc/apache2/sites-available/[project-directory].conf<br>
                                sudo nano /etc/apache2/sites-available/[project-directory].conf<br>
                                [CHANGE THIS] #ServerName www.example.com --- remove the #, change www.example.com to your link<br>
                                [CHANGE THIS] DocumentRoot /var/www/html --- delete html to [project-directory]<br>
                                sudo mkdir /var/www/[project-directory]<br>
                                sudo chown ubuntu /var/www/[project-directory]<br>
                                sudo a2ensite [project-directory]<br>
                                sudo systemctl reload apache2<br>
                                sudo certbot --apache<br>
                            </code>
                        </pem>
                    </p>
                </section>

                <section>
                    <h2> Ownership Changes </h2>
                    <p> I notice that the Configuration Files (conf) files don't change to Ubuntu on creation: </p>
                    <p>
                        <pem>
                            <code>
                                sudo chown ubuntu /etc/apache2/sites-available/[project-directory].conf<br>
                                sudo chown ubuntu /etc/apache2/sites-available/[project-directory]-le-ssf.conf<br>
                            </code>
                        </pem>
                    </p>
                </section>

                <section>
                    <h2> Python </h2>
                    <p> Two simple commands, just be in your [project-directory]</p>
                    <p>cd /var/www/[project-directory]</p>
                    <p>
                        <pem>
                            <code>
                                python3 -m venv venv<br>
                                source venv/bin/activate<br>
                            </code>
                        </pem>
                    </p>
                    <p>First line installs a Python Enviroment to the Project. <br>The second line activates the Python
                        Enviroment, you will notice your cmd changed to (venv) instead of ubuntu</p>
                </section>

                <section>
                    <h2> Packages </h2>
                    <p> You can copy this whole block of code and paste it into the PuTTY cmd and it will run them all
                        instead of going one at a time</p>
                    <p>
                        <pem>
                            <code>
                                pip install django<br>
                                sudo apt install libapache2-mod-wsgi-py3<br>
                                sudo apt install default-libmysqlclient-dev<br>
                                pip install wheel<br>
                                pip install pillow<br>
                                pip install mysqlclient<br>
                            </code>
                        </pem>
                    </p>
                    <p>Djano is needed for making a Django application. WSGI is to make it so Django can run on an
                        Apache Server. The rest is for Database Management stuff</p>
                </section>

                <section>
                    <h2> Django </h2>
                    <p> One simple command to make a Django Project</p>
                    <p>
                        <pem>
                            <code>
                                django-admin startproject [name]<br>
                            </code>
                        </pem>
                    </p>
                </section>

                <section>
                    <h2> Django: File Moving </h2>
                    <p> This is 100% OPTIONAL! It makes your project directory cleaner and meaning you don't need to
                        have so much in File Pathways</p>
                    <p>
                        <pem>
                            <code>
                                mv [django-project-name]/manage.py ./<br>
                                mv [django-project-name]/[django-project-name]/* [django-project-name]<br>
                                rm -r [django-project-name]/[django-project-name]/<br>
                            </code>
                        </pem>
                    </p>
                    <p>
                        This basically makes it so you have [project-directory]/[django-project-name] instead of
                        [project-directory]/[django-project-name]/[django-project-name]
                    </p>
                </section>

                <section>
                    <h2> Django: Allow Hosts </h2>
                    <p> Allowing the host makes it so you can run your Django on your link that you have</p>
                    <p>
                        <pem>
                            <code>
                                sudo nano /var/www/[project-directory]/[django-project-name]/settings.py/<br>
                            </code>
                        </pem>
                    </p>
                    <p>
                        simply edit the ALLOWED_HOSTS = [] to be ALLOWED_HOSTS = ['link'] -- Link being your website
                        link
                    </p>
                </section>

                <section>
                    <h2> Django: Migrations </h2>
                    <p> Migrating files so it knows whats what, basically a reload. Do note: you will need to run this
                        again when you have finished making your APP side of Django</p>
                    <p>
                        <pem>
                            <code>
                                python manage.py makemigrations<br>
                                python manage.py migrate <br>
                            </code>
                        </pem>
                    </p>
                </section>

                <section>
                    <h2> Django: Running Server </h2>
                    <p> THIS IS ONLY FOR DEVELOPMENT! this will only work on http://[yourlink]:8000, you should once
                        everything is operational be able to just go to https://[yourlink] without running this server
                    </p>
                    <p>
                        <pem>
                            <code>
                                python manage.py runserver 0.0.0.0:8000<br>
                            </code>
                        </pem>
                    </p>
                </section>

                <section>
                    <h2> Django: Database </h2>
                    <p> Adding a database is rather simple, though do note the values you change</p>
                    <p>
                        <pem>
                            <code>
                                sudo mysql -u root -p
                                CREATE DATABASE [database_name] CHARACTER SET utf8 COLLATE utf8_general_ci;<br>
                                CREATE USER '[database_user]'@'localhost' IDENTIFIED BY '[your_password]';<br>
                                GRANT ALL PRIVILEGES ON [database_name].* TO '[database_user]'@'localhost';<br>
                                exit<br>
                            </code>
                        </pem>
                    </p>
                    <p> Quote Marks are needed around the database_user and your_password. These values can be anything
                        by the way</p>
                    <p> You can now edit your [django-project-name]/settings.py with the database you just made. In this
                        case the defaults is using Sqlite where as we use MySQL</p>
                    <p> An example:<br>
                        <pem>
                            <code>
                                    sudo nano /var/www/[project-directory]/[django-project-name]/settings.py<br><br>
                                    DATABASES = {<br>
                                    'default': {<br>
                                            'ENGINE': 'django.db.backends.mysql',<br>
                                            'NAME': 'database',<br>
                                            'USER':'user',<br>
                                            'PASSWORD':'password',<br>
                                            'HOST':'localhost',<br>
                                            'PORT':'3306'<br>
                                        }<br>
                                    }<br>
                                </code>
                        </pem>
                    <p>
                        The ENGINE gets changed to MySQL, we add NAME, USER, PASSWORD to match what we maed. HOST and
                        PORT exist
                    </p>
                    </p>
                </section>

                <section>
                    <h2>Django: WSGI</h2>
                    <p>There has been issues with this one. It seems to be hit and miss and its always to be done with
                        File Paths. Even if you think its right, nope you are most likely wrong. Right Click and Copy
                        the Path from WinSCP for this and then like double check!</p>
                    <p>This all goes in the /etc/apache2/sites-available/[project-directory]-le-ssf.conf</p>
                    <p><b>NOTE: The . seen in the below commands is there because there is no escape character and it
                            breaks</b></p>
                    <p>
                        <pem>
                            <code>
                                <.Directory /var/www/[project-directory]/[django-project-name]><br>
                                    <.Files wsgi.py><br>
                                        Require all granted<br>
                                    <./Files><br>
                                    <./Directory><br>
                                    
                                    WSGIDaemonProcess [wsgi_proj_name] python-path=/var/www/[project-directory]/[django-project-name] python-home=/var/www/[project-directory]/[django-project-name]/venv<br>
                                    WSGIProcessGroup [wsgi_proj_name]<br>
                                    WSGIScriptAlias / /var/www/[project-directory]/[django-project-name]/wsgi.py<br>
                            </code>
                        </pem>
                    </p>
                    <p> This gets slotted down the bottom but above the SSL lines. [wsgi_proj_name] can be whatever name
                        you want be keep in mind you can only give this name ONCE to a project.</p>
                </section>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>